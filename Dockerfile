FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"LS0tCnZlcnNpb246IDEuMApuYW1lOiBhcGljYXN0LWFwYgpkZXNjcmlwdGlvbjogQW4gb3BlbiBz\
b3VyY2UgQVBJIGdhdGV3YXkKYmluZGFibGU6IGZhbHNlCmFzeW5jOiBvcHRpb25hbAptZXRhZGF0\
YToKICBkaXNwbGF5TmFtZTogQVBJQ2FzdCAoQVBCKQogIGxvbmdEZXNjcmlwdGlvbjogVGhpcyBB\
bnNpYmxlIFBsYXlib29rIEJ1bmRsZSB0byBkZXBsb3kgdGhlIDNzY2FsZSBBUEkgZ2F0ZXdheQog\
IGRvY3VtZW50YXRpb25Vcmw6IGh0dHBzOi8vc3VwcG9ydC4zc2NhbGUubmV0L2RvY3MKICBwcm92\
aWRlckRpc3BsYXlOYW1lOiBSZWQgSGF0LCBJbmMuCiAgY29uc29sZS5vcGVuc2hpZnQuaW8vaWNv\
bkNsYXNzOiBpY29uLWxvYWQtYmFsYW5jZXIKdGFnczoKICAtIDNzY2FsZQogIC0gYXBpCiAgLSBn\
YXRld2F5CnBsYW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IERlZmF1bHQg\
cGxhbgogICAgZnJlZTogdHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1lOiBEZWZh\
dWx0CiAgICAgIGxvbmdEZXNjcmlwdGlvbjogfC0KICAgICAgICBUaGlzIHBsYW4gZGVwbG95cyBh\
IDNzY2FsZSBnYXRld2F5ICgiQVBJY2FzdCIpLiBZb3UgbXVzdCBoYXZlCiAgICAgICAgYWNjZXNz\
IHRvIGFuIGFkbWluIGFjY291bnQgaW4gYW4gQVBJIE1hbmFnZW50IFBsYXRmb3JtIGVudmlyb25t\
ZW50CiAgICAgICAgYW5kIG9idGFpbiBhbiBhY2Nlc3MgdG9rZW4gZm9yIHRoZSBhY2NvdW50IG1h\
bmFnZW1lbnQgQVBJLiBUaGlzCiAgICAgICAgQVBCIHJlcXVpcmVzIHRoYXQgdG9rZW4gYW5kIHRo\
ZSBhZGRyZXNzIG9mIHRoZSBtYW5hZ2VtZW50IEFQSQogICAgICAgIGVuZHBvaW50LgogICAgICBj\
b3N0OiAkMC4wMAogICAgcGFyYW1ldGVyczoKICAgICAgLSBuYW1lOiBtYW5hZ2VtZW50X2hvc3QK\
ICAgICAgICB0aXRsZTogSG9zdG5hbWUgKGFuZCBvcHRpb25hbCA6cG9ydCkgb2YgdGhlIGFjY291\
bnQgbWFuYWdlbWVudCBBUEkKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB2YWx1ZTogbXlk\
b21haW4tYWRtaW4uM3NjYWxlLm5ldAogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFt\
ZTogYWNjZXNzX3Rva2VuCiAgICAgICAgdGl0bGU6IEFjY2VzcyB0b2tlbiBmb3IgdGhlIEFjY291\
bnQgTWFuYWdlbWVudCBBUEkKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDog\
dHJ1ZQogICAgICAtIG5hbWU6IGRlcGxveV9lbnZpcm9ubWVudAogICAgICAgIHRpdGxlOiBEZXBs\
b3ltZW50IGVudmlyb25tZW50CiAgICAgICAgZGVmYXVsdDogcHJvZHVjdGlvbgogICAgICAgIHR5\
cGU6IGVudW0KICAgICAgICBlbnVtOiBbJ3Byb2R1Y3Rpb24nLCAnc2FuZGJveCddCiAgICAgICAg\
cmVxdWlyZWQ6IHRydWUKICAgICAgLSBuYW1lOiBjb25maWdfbG9hZGVyCiAgICAgICAgdGl0bGU6\
IFdoZW4gdG8gbG9hZCBjb25maWcuIEF0IHN0YXJ0IChib290KSBvciBpbmNvbWluZyByZXF1ZXN0\
IChsYXp5KQogICAgICAgIHR5cGU6IGVudW0KICAgICAgICBlbnVtOiBbJ2Jvb3QnLCAnbGF6eSdd\
CiAgICAgICAgZGVmYXVsdDogYm9vdAogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFt\
ZTogYmFja2VuZF9jYWNoZV9oYW5kbGVyCiAgICAgICAgdGl0bGU6IEhvdyB0byBoYW5kbGUgYW5k\
IGNhY2hlIGJhY2tlbmQgYXV0aG9yaXphdGlvbiByZXNwb25zZXMuCiAgICAgICAgdHlwZTogZW51\
bQogICAgICAgIGVudW06IFsnc3RyaWN0JywgJ3Jlc2lsaWVudCddCiAgICAgICAgZGVmYXVsdDog\
c3RyaWN0CiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgLSBuYW1lOiByZXNvbHZlcgogICAg\
ICAgIHRpdGxlOiBETlMgUmVzb2x2ZXIgZm9yIG9wZW5yZXN0eSwgaWYgZW1wdHkgaXQgd2lsbCBi\
ZSBhdXRvZGlzY292ZXJlZAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBm\
YWxzZQogICAgICAtIG5hbWU6IGxvZ19sZXZlbAogICAgICAgIHRpdGxlOiBMb2cgbGV2ZWwuCiAg\
ICAgICAgdHlwZTogZW51bQogICAgICAgIGRlZmF1bHQ6IG5vdGljZQogICAgICAgIGVudW06CiAg\
ICAgICAgICAtIGRlYnVnCiAgICAgICAgICAtIGluZm8KICAgICAgICAgIC0gbm90aWNlCiAgICAg\
ICAgICAtIHdhcm4KICAgICAgICAgIC0gZXJyb3IKICAgICAgICAgIC0gY3JpdAogICAgICAgICAg\
LSBhbGVydAogICAgICAgICAgLSBlbWVyZwogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0g\
bmFtZTogb2F1dGhfdG9rZW5zX3R0bAogICAgICAgIHRpdGxlOiBUVEwgKGluIHNlY29uZHMpIG9m\
IHRoZSBvYXV0aCB0b2tlbnMgY3JlYXRlZC4KICAgICAgICB0eXBlOiBpbnQKICAgICAgICBkZWZh\
dWx0OiA2MDQ4MDAKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IHNlcnZpY2Vf\
bGlzdAogICAgICAgIHRpdGxlOiBTdWJzZXQgb2Ygc2VydmljZXMgdG8gcnVuLiBDb21tYSBzZXBh\
cmF0ZWQgaWRzIChlZy4gNDIsMTMzNykKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1\
aXJlZDogZmFsc2UKICAgICAgLSBuYW1lOiBjb25maWdfY2FjaGUKICAgICAgICB0aXRsZTogPi0K\
ICAgICAgICAgIEZvciBob3cgbG9uZyB0byBjYWNoZSB0aGUgZG93bmxvYWRlZCBjb25maWd1cmF0\
aW9uIChzZWNvbmRzKS4KICAgICAgICAgIENhbiBiZSBsZWZ0IGVtcHR5LCAwIG9yIGdyZWF0ZXIg\
dGhhbiA2MC4KICAgICAgICB0eXBlOiBpbnQKICAgICAgICByZXF1aXJlZDogZmFsc2UKICAgICAg\
LSBuYW1lOiByZWRpc191cmwKICAgICAgICB0aXRsZTogPi0KICAgICAgICAgIFJlZGlzIFVSTC4g\
UmVxdWlyZWQgZm9yIE9BdXRoMiBpbnRlZ3JhdGlvbi4KICAgICAgICAgIGUuZy4gcmVkaXM6Ly9Q\
QVNTV09SREAxMjcuMC4wLjE6NjM3OS8wCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVx\
dWlyZWQ6IGZhbHNlCiAgICAgIC0gbmFtZTogbWFuYWdlbWVudF9zY29wZQogICAgICAgIHRpdGxl\
OiA+LQogICAgICAgICAgU2NvcGUgb2YgdGhlIE1hbmFnZW1lbnQgQVBJLiBBdCBsZWFzdCAnc3Rh\
dHVzJwogICAgICAgICAgcmVxdWlyZWQgZm9yIGhlYWx0aCBjaGVja3MuCiAgICAgICAgdHlwZTog\
ZW51bQogICAgICAgIGVudW06IFsnZGlzYWJsZWQnLCAnc3RhdHVzJywgJ2RlYnVnJ10KICAgICAg\
ICBkZWZhdWx0OiBzdGF0dXMKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IHRs\
c192ZXJpZnkKICAgICAgICB0aXRsZTogRW5hYmxlIFRMUy9TU0wgcGVlciB2ZXJpZmljYXRpb24u\
CiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkZWZhdWx0OiB0cnVlCiAgICAgICAgdHlw\
ZTogYm9vbGVhbgogICAgICAtIG5hbWU6IHJlc3BvbnNlX2NvZGVzCiAgICAgICAgdGl0bGU6IEVu\
YWJsZSBsb2dnaW5nIHJlc3BvbnNlIGNvZGVzIHRvIDNzY2FsZS4KICAgICAgICB0eXBlOiBib29s\
ZWFuCiAgICAgICAgZGVmYXVsdDogZmFsc2UKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAt\
IG5hbWU6IHBhdGhfcm91dGluZwogICAgICAgIHRpdGxlOiBFbmFibGUgcGF0aCByb3V0aW5nLiBF\
eHBlcmltZW50YWwgZmVhdHVyZS4KICAgICAgICB0eXBlOiBib29sZWFuCiAgICAgICAgZGVmYXVs\
dDogZmFsc2UKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IGNvbmZpZ19maWxl\
CiAgICAgICAgdGl0bGU6IE92ZXJyaWRlIEpTT04gY29uZmlndXJhdGlvbiBmaWxlIGZvciB0aGUg\
Z2F0ZXdheQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIGRpc3BsYXlfdHlwZTogdGV4dGFy\
ZWEKICAgICAgICByZXF1aXJlZDogZmFsc2UK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles

# The xml ansible module requires the lxml python library installed
RUN yum install -y python-lxml && yum clean all

USER apb
